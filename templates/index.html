{% extends "base.html" %}
{% block content %}
<h3>Summary</h3>
<p><b>Income: </b>{{ income }} BGN</p>
<p><b>Expense: </b>{{ expense }} BGN</p>
<p><b>Balance: </b>{{ balance }} BGN</p>

<hr>

<div class="row g-4">
  <!-- Card 1: Pie -->
  <div class="col-12 col-md-6">
    <div class="card shadow-sm h-100">
      <div class="card-header">
        <h5 class="mb-0">Expenses by Category</h5>
      </div>
      <div class="card-body d-flex justify-content-center">
        {% if cat_labels|length > 0 %}
          <div class="chart-box">
            <canvas id="categoryChart"></canvas>
          </div>
        {% else %}
          <p class="text-muted m-0">No expense data for categories yet.</p>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Card 2: Bar -->
  <div class="col-12 col-md-6">
    <div class="card shadow-sm h-100">
      <div class="card-header">
        <h5 class="mb-0">Monthly Income vs Expense</h5>
      </div>
      <div class="card-body d-flex justify-content-center">
        {% if months|length > 0 %}
          <div class="chart-box">
            <canvas id="monthlyChart"></canvas>
          </div>
        {% else %}
          <p class="text-muted m-0">No monthly data yet.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<script>
    console.log("cat_labels:", {{ cat_labels|tojson }});
    console.log("cat_values:", {{ cat_values|tojson }});
    console.log("months:", {{ months|tojson }});
    console.log("income_vals:", {{ income_vals|tojson }});
    console.log("expense_vals:", {{ expense_vals|tojson }});

    window.onload = function() {
    	renderCategoryChart({{ cat_labels|tojson }}, {{ cat_values|tojson }});
        renderMonthlyChart({{ months|tojson }}, {{ income_vals|tojson }}, {{ expense_vals|tojson }});
    }
</script>
{% endblock %}	